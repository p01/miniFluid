<doctype html>
<tt>
<h2>MiniFluid</h2>
<p>A micro fluid simulation inspired by <a href="https://www.ioccc.org/2012/endoh1/hint.html">endoh1.c</a> and its TS port <a href="https://github.com/phiresky/endoh1-ts">endoh1-ts</a>
<p>Golfed by <a href=https://twitter.com/xem rel=noopener>xem</a>, <a href=https://twitter.com/p01 rel=noopener>p01</a>, <a href=https://twitter.com/aemkei rel=noopener>Aemkei</a>, <a href=https://twitter.com/IrratixMusic rel=noopener>Irratix</a>, <a href=https://twitter.com/RReverser rel=noopener>RReverser</a>
<p><canvas id=c style="height:300px"></canvas>
<p>Input:<p>
<textarea id=O cols=128 rows=27>
                                                               
                                                               
                                                               
                                                               
##     _=a=[];fo  r(C o                               f O.v  ##
##    alue)_++,   C>' '                 &&a.p         ush({  ##
##    x:_%6       4,y:_                 >>6,C         ,w:'$  ##
##    '>C,u       :0,v:                               0});M  ##
##  =o=>a.map(    p=>{p   .t=.1  ;p.s=  0;o||     (p.D=p.w)  ##
## ;a.map(q=>     (g=Ma   th.hy  pot(e  =p.x-   q.x,f=p.y-q  ##
##    .y)/2       -1)<0   ?o?(g  /=p.D  ,p.t+  =(f*(z=3-p.D  ##
##    -q.D)       +p.v-   q.v)*  g,p.s  +=(e*  z+p.u  -q.u)  ##
##    *g):p       .D+=g   *g:1)  });se  tInte  rval`  M(c.w  ##
##    idth^       =M())   ;for(  p of   a)wit  h(p)c  .getC  ##
##    ontex       t('2d   ').fillText(  C,3*x  ,5*y),w||(y+  ##
##    =v+=t       /4,x+=  u+=s/2)`//th  is is  just a test.  ##
##   // hi,       world..  codegolf...  team..  // 01-2022.  ##
##                                                           ##
##                                                           ##
##                                                           ##
##                                                           ##
##                                                           ##
##(   ,(   ,(   ,(   ,(   ,(   ,(   ,(   ,(   ,(   ,(   ,(   ##
## `-'  `-'  `-'  `-'  `-'  `-'  `-'  `-'  `-'  `-'  `-'  `-'##
##                                                           ##
###############################################################
###############################################################
</textarea>

<script>
_=a=[];for(C of O.value)_++,C!=0&&a.push({x:_%64,y:_>>6,C,w:'$'>C,u:0,v:0});M=o=>a.map(p=>{p.t=.1;p.s=0;o||(p.D=p.w);a.map(q=>(g=Math.hypot(e=p.x-q.x,f=p.y-q.y)/2-1)<0?o?(g/=p.D,p.t+=(f*(z=3-p.D-q.D)+p.v-q.v)*g,p.s+=(e*z+p.u-q.u)*g):p.D+=g*g:1)});setInterval('M(c.width^=M());for(p of a)with(p)c.getContext`2d`.fillText(C,3*x,5*y),w||(y+=v+=t/4,x+=u+=s/2)',20)
</script>
